---
import type { CollectionEntry } from "astro:content";
import { getEntry } from "astro:content";

interface Props {
  post: CollectionEntry<"posts">;
}

const { post } = Astro.props;
const categories = [];
for (const cat of post.data.categories) {
  const category = await getEntry(cat.collection, cat.id);
  categories.push(category);
}
---

<article class="card">
  <figure class="card__figure">
    <img
      class="card__img"
      src={post.data.image.src}
      alt={post.data.title}
      style={`view-transition-name: ${post.id}-image;`}
    />
  </figure>
  <div class="container-category">
    {
      categories.map((cat) => (
        <a
          href={`/blog/categories/${cat?.data.id}`}
          class="category"
          style={`--category-color: var(${cat?.data.color})`}
        >
          {cat?.data.name}
        </a>
      ))
    }
  </div>
  <h2 class="title" style={`view-transition-name: ${post.id}-title;`}>
    {post.data.title}
  </h2>
  <p class="excerpt">{post.data.summary}</p>
  <div class="footer">
    <a href={`/blog/${post.id}`}>Leer m√°s</a>
  </div>
</article>

<style>
  .card {
    overflow: hidden;
    display: grid;

    border: 1px solid var(--primary-color);
    border-radius: 8px;

    transition: box-shadow 0.3s;
  }

  .card:hover {
    box-shadow: 0 4px 8px rgb(0 0 0 / 20%);
  }

  .card__figure {
    margin: 0;
  }

  .card__img {
    aspect-ratio: 16/10;
    width: 100%;
    height: auto;
  }

  .container-category {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: space-between;

    margin: 8px 0;
    padding: 0 12px;
  }

  .category {
    display: inline-block;

    margin: 8px 0;
    padding: 2px 6px;
    border: 1px solid var(--category-color);
    border-radius: 4px;

    font-size: 12px;
    color: var(--category-color);
    text-decoration: none;

    transition: all 0.3s ease-in-out;
  }

  .category:hover {
    color: #fff;
    background-color: var(--category-color);
  }

  .title {
    margin: 8px 0;
    padding: 0 12px;

    font-size: 18px;
    font-weight: bold;
    color: var(--acento-btn);
    text-align: center;
  }

  .excerpt {
    margin: 8px 0;
    padding: 0 12px;

    font-size: 14px;
    color: var(--text-color);
    text-align: left;
  }

  .footer {
    display: flex;
    align-items: center;
    justify-content: center;

    text-align: right;

    background-color: var(--h3-color);
  }

  .footer a {
    width: 100%;
    height: 100%;
    padding: 8px 12px;

    font-size: 1.3rem;
    font-weight: 600;
    color: #e6e0e7;
    text-decoration: none;

    transition: all 300ms ease-in-out;
  }

  .footer a:hover {
    color: var(--acento-btn-hover);
    text-decoration: underline;
    background-color: var(--color-3);
  }
</style>
