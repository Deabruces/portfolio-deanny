---
import Icon from "./Icon.astro";
import ExternalLink from "../assets/icons/external-link.svg";
import { Image } from "astro:assets";

interface Props {
  link: string;
  title: string;
  image: ImageMetadata;
  summary: string;
  tags: string[];
  date?: string;
  identifier?: string;
}
const { title, image, summary, tags, link, identifier } = Astro.props;
const ImgAnimationName = "image--" + identifier;
const TitleAnimationName = "title--" + identifier;
---

<article class="card">
  <header class="card__header">
    <figure class="card__figure">
      <Image class="card__img" src={image} alt={title} />
    </figure>
    <h2 class="header__title">{title}</h2>
  </header>
  <div class="card__content">
    <p class="content__text">
      {summary}
    </p>
  </div>
  <footer class="card__footer">
    <div class="card__icons">
      {
        tags.map((tag) => {
          return <Icon name={tag} />;
        })
      }
    </div>
    <div class="footer__link">
      <a href={link} class="footer__links-external">
        <span class="footer__link-external">
          <span class="text-view-project">Ver proyecto</span>
          <span class="icono-view-project"><ExternalLink /></span>
        </span>
      </a>
    </div>
  </footer>
</article>

<style
  define:vars={{
    "img-animation-name": ImgAnimationName,
    "title-animation-name": TitleAnimationName,
  }}
>
  .card {
    display: flex;
    flex-direction: column;

    max-width: 388px;
    border: 1px solid var(--acento-btn);
    border-radius: 20px;

    background-color: var(--background-color);
    box-shadow: 0 4px 8px rgb(87 87 87 / 10%);

    transition: scale 0.2s ease-in-out;
  }

  .card:hover {
    scale: 1.02;
    border-color: var(--acento-btn);
    box-shadow: 0 6px 12px rgb(0 0 0 / 20%);
  }

  .card__header {
    color: var(--text-color);
  }

  .header__title {
    margin-top: 5px;
    padding: 15px 32px 5px;

    font-size: clamp(1.25rem, 1.375vw, 1.5rem);
    font-weight: 600;
    line-height: 1.2;
    color: var(--acento-btn);

    view-transition-name: var(--title-animation-name);
  }

  .card__img {
    aspect-ratio: 16/10;
    width: 100%;
    height: auto;
    border-radius: 20px 20px 0 0;

    view-transition-name: var(--img-animation-name);
  }

  .card__content {
    flex-grow: 1;
    padding: 5px 32px 15px;
    color: var(--text-color);
  }

  .content__text {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;

    font-size: clamp(0.875rem, 0.9375vw, 1rem);
    font-weight: 400;
    line-height: 1.3;
    color: var(--text-color);
  }

  .card__icons {
    display: flex;
    flex-flow: row wrap;
    gap: 5px;
    align-items: center;
    justify-content: start;

    padding: 10px 0;

    color: var(--secondary-color);
  }

  .card__icons :global(svg) {
    width: 24px;
    height: 24px;
  }

  .footer__link-external {
    display: flex;
    flex-direction: row;
    flex-shrink: 2;
    gap: 5px;
    align-items: center;
    justify-content: end;

    font-size: 18px;
    text-decoration: none;
  }

  .text-view-project {
    font-size: 0.8rem;
    font-weight: 600;
    line-height: 1.2;
  }

  .icono-view-project {
    width: 24px;
    height: 24px;
    transition: color 0.3s ease;
  }

  .icono-view-project:hover {
    color: var(--acento-btn-hover);
  }

  .footer__link {
    min-width: 44%;
    padding: 5px;
    border-radius: 30px;

    color: var(--text-color);
    text-decoration: none;

    background-color: var(--acento-btn);

    transition:
      color 0.3s ease,
      background-color 0.3s ease;
  }

  .footer__link:hover {
    color: var(--text-color);
    background-color: var(--acento-btn-hover);
  }

  .card__footer {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;

    min-height: 77px;
    padding: 2px 20px;
    border-radius: 0 0 20px 20px;

    font-weight: 400;
    color: var(--text-color);
    text-align: end;

    background-color: var(--primary-color);
  }

  .footer__links-external {
    display: flex;
    flex-direction: row;
    gap: 5px;
    align-items: center;
    justify-content: center;

    font-size: 2rem;
    color: var(--text-color);
    text-decoration: none;
  }
</style>
