<form
  action="https://formsubmit.co/1a1ffeb0c7e37244eeecaf2edad1c061"
  class="form"
  method="POST"
>
  <ul class="form__ul">
    <li class="form__li">
      <label class="form__label" for="name">Nombre y Apellido:</label>
      <input
        class="form-input"
        id="name"
        name="user_name"
        placeholder="tu nombre y apellido"
        required
        type="text"
      />
    </li>
    <li class="form__li">
      <label class="form__label" for="mail">Email:</label>
      <input
        class="form-input"
        id="mail"
        name="email"
        placeholder="tu email"
        required
        type="email"
      />
    </li>
    <li class="form__li">
      <label class="form__label" for="msg">Mensaje:</label>
      <textarea
        class="form__textarea"
        id="msg"
        name="user_message"
        placeholder="Ej.: Â¿QuÃ© tienes en mente?"
        required
        rows="6"></textarea>
    </li>
    <div class="form__send">
      <input class="form-input__btn" type="submit" value="Â¡Hablemos!" />
      <p class="form__response">
        Generalmente respondo dentro de 1 o 2 dÃ­as hÃ¡biles.
      </p>
    </div>
  </ul>
  <input name="_captcha" type="hidden" value="false" />
</form>

<div class="gratitude hidden">
  Â¡Gracias por tu mensaje! Me pondrÃ© en contacto contigo pronto ðŸ˜Š
</div>
<div class="error hidden">
  Estoy teniendo problemas para entregar tu mensaje. Por favor, intenta de nuevo
  mÃ¡s tarde.
</div>

<style>
  .hidden {
    opacity: 0;
  }

  .form__ul {
    display: flex;
    flex-direction: column;
    align-items: start;
    padding-inline-start: 0;
  }

  .form__li {
    display: flex;
    flex-direction: column;

    width: 100%;
    margin-bottom: 2rem;

    list-style: none;
  }

  .form-input {
    width: 100%;
    height: 40px;
    border: 1px solid var(--acento-btn);
    border-radius: 5px;

    background-color: var(--background-color);
    outline: none;
  }

  .form__textarea {
    border: 1px solid var(--acento-btn);
    border-radius: 5px;
    background-color: var(--background-color);
    outline: none;
  }

  .form-input:focus,
  .form__textarea:focus {
    border: 2px solid var(--secondary-color);
  }

  .form-input::placeholder,
  .form__textarea::placeholder {
    padding: 1rem;
    color: var(--text-color);
    opacity: 0.5;
  }

  .form__send {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .form-input__btn {
    border: 1px solid var(--acento-btn);
    border-radius: 20px;

    font-weight: 600;
    color: #ffff;

    background-color: var(--acento-btn);

    transition: all 300ms ease-in-out;
  }

  .form-input__btn[disabled] {
    cursor: not-allowed;
    background-color: var(--border-color);
  }

  .form-input__btn:hover {
    border: 1px solid var(--acento-btn-hover);
    color: #ffff;
    background-color: var(--acento-btn-hover);
  }

  .form__response {
    margin-top: 0.5rem;
    font-size: 0.9rem;
    color: var(--text-color);
  }

  .gratitude {
    padding: 1rem;
    border: 1px solid var(--border-color);
    border-radius: 5px;
    transition: opacity 0.3s;
  }

  .error {
    padding: 1rem;
    border: 1px solid red;
    border-radius: 5px;
    transition: opacity 0.3s;
  }
</style>

<script>
  let form = document.querySelector<HTMLFormElement>(".form");
  let ok = document.querySelector(".gratitude");
  let errorM = document.querySelector(".error");

  const showGratitude = (e: SubmitEvent) => {
    e.preventDefault();
    console.log("enviando");
    let button = document.querySelector<HTMLButtonElement>(".form-input__btn");
    button!.disabled = true;
    const formulario = e.target as HTMLFormElement;
    const data = new FormData(formulario);
    const url = formulario.action;
    const method = formulario.method;
    fetch(url, { body: data, method })
      .then(() => {
        ok?.classList.remove("hidden");
        console.log("enviado");
      })
      .catch(() => {
        errorM?.classList.remove("hidden");
      })
      .finally(() => {
        button!.disabled = false;
        formulario.reset();
        setTimeout(() => {
          ok?.classList.add("hidden");
          errorM?.classList.add("hidden");
        }, 3000);
      });
  };
  form?.addEventListener("submit", showGratitude);
</script>
